<!-- Botón y tabla de acreedores -->
<div class="auth-box card">
    <div class="card-block">
        <h4 class="sub-title m-t-20">Acreedores</h4>
        <div class="row">
            <div class="col-md-12 m-b-10">
                <button type="button" class="btn btn-info btn-sm" (click)="openModal(modalAcreedor)">
                    <i class="fa fa-plus"></i> Nuevo acreedor
                </button>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 table-responsive">
                <table class="table table-striped">
                    <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Banco</th>
                        <th>Plazo</th>
                        <th>Moneda</th>
                        <th>Comentarios</th>
                        <th>Acciones</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr *ngFor="let row of acreedores">
                        <td>{{ row.nombre }}</td>
                        <td>{{ row.banco || '-' }}</td>
                        <td>{{ row.plazo }}</td>
                        <td>{{ row.moneda }}</td>
                        <td>{{ row.comentarios }}</td>
                        <td>
                            <button class="btn btn-outline-primary btn-action mr-1" style="padding: 4px 10px; font-size: 1.1rem;" (click)="openModal(modalAcreedor, row)">
                                <i class="fa fa-pen"></i>
                            </button>
                            <button class="btn btn-outline-danger btn-action" style="padding: 4px 10px; font-size: 1.1rem;" (click)="eliminar(row)">
                                <i class="fa fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                    <tr *ngIf="acreedores.length === 0">
                        <td colspan="6" class="text-center">Sin acreedores registrados</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Modal crear/editar acreedor -->
<ng-template #modalAcreedor let-c="close" let-d="dismiss">
    <div class="modal-header">
        <h4 class="modal-title">{{ data.id ? 'Editar' : 'Nuevo' }} acreedor</h4>
        <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <form class="md-float-material form-material" #formAcreedor="ngForm" (ngSubmit)="guardarAcreedor(c)">
        <div class="modal-body">
            <div class="row">
                <!-- NOMBRE -->
                <div class="col-md-12 m-b-10">
                    <div class="form-group form-primary">
                        <input type="text" class="form-control" name="nombre" [(ngModel)]="data.nombre" required maxlength="100">
                        <span class="form-bar"></span>
                        <label class="float-label">Nombre</label>
                        <small class="text-danger messages block" *ngIf="formAcreedor.submitted && !data.nombre">Campo requerido</small>
                    </div>
                </div>
                <!-- BANCO -->
                <!-- BANCO: Búsqueda + Select -->
                <div class="col-md-8" [hidden]="bancosBuscados.length > 0">
                    <div class="form-group form-primary">
                        <input
                            type="text"
                            name="banco_input"
                            class="form-control"
                            [(ngModel)]="data.banco_input"
                            (keyup.enter)="buscarBanco()"
                            maxlength="100"
                        />
                        <span class="form-bar"></span>
                        <label class="float-label">Buscar banco</label>
                    </div>
                </div>
                <div class="col-md-8" [hidden]="bancosBuscados.length == 0">
                    <div class="form-group form-primary">
                        <select
                            name="select_banco"
                            class="form-control"
                            [(ngModel)]="data.banco"
                            required
                        >
                            <option value="" selected disabled></option>
                            <option
                                value="{{ banco.id }}"
                                *ngFor="let banco of bancosBuscados"
                            >
                                {{ banco.nombre }}
                            </option>
                        </select>
                        <span class="form-bar"></span>
                        <label class="float-label">Seleccionar banco</label>
                        <small class="text-danger messages block" *ngIf="formAcreedor.submitted && !data.banco">Campo requerido</small>
                    </div>
                </div>
                <div class="col-md-2">
                    <button type="button" class="btn btn-info btn-sm btn-block" (click)="buscarBanco()">
                        Buscar
                    </button>
                </div>

                <!-- PLAZO -->
                <div class="col-md-12 m-b-10">
                    <div class="form-group form-primary">
                        <input type="number" class="form-control" name="plazo" [(ngModel)]="data.plazo" required min="1" max="999">
                        <span class="form-bar"></span>
                        <label class="float-label">Plazo (días)</label>
                        <small class="text-danger messages block" *ngIf="formAcreedor.submitted && !data.plazo">Campo requerido</small>
                    </div>
                </div>
                <!-- MONEDA -->
                <div class="col-md-12 m-b-10">
                    <div class="form-group form-primary">
                        <select name="moneda" class="form-control" [(ngModel)]="data.moneda" required>
                            <option value="" selected disabled></option>
                            <option *ngFor="let moneda of monedas" [value]="moneda.id">
                                {{ moneda.moneda }}
                            </option>
                        </select>
                        <span class="form-bar"></span>
                        <label class="float-label">Moneda</label>
                        <small class="text-danger messages block" *ngIf="formAcreedor.submitted && !data.moneda">Campo requerido</small>
                    </div>
                </div>
                <!-- COMENTARIOS -->
                <div class="col-md-12 m-b-10">
                    <div class="form-group form-primary">
                        <textarea class="form-control" name="comentarios" [(ngModel)]="data.comentarios" maxlength="255"></textarea>
                        <span class="form-bar"></span>
                        <label class="float-label">Comentarios</label>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer" style="border-top: none;">
            <button type="submit" class="btn btn-info btn-block" [disabled]="formAcreedor.invalid">
                <i class="fa fa-save"></i> Guardar
            </button>
        </div>
    </form>
</ng-template>
